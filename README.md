# 诱导界面审计平台web模块
- 前端主要有的功能：登录/注册、上传app，展示审计报告
- 后台（java）：把上传的app先存储起来，然后存个审计任务到消息队列
- 审计后台（python）：从消息队列读取任务，完成审计任务，将结果写入数据库
## 前端
### 页面1：注册/登录
### 页面2：app审计上传
包括：
- app上传接口
- 历史上传记录，记录包括：提交hash（(10位的随机字符串，后台自动生成）、app的package name、app的版本号、提交时间、审计完成状态（未完成 or 已完成）
### 页面3：审计结果查询
  包括：
- 提交hash查询接口
- 审计结果报告下载接口
- 审计报告web展示，展示内容包括：
    - app的基本信息：提交hash、app的package name、app的名字、app的版本号、提交时间、审计完成状态
    - 各个类别的查询结果，比如：
        - 虚假按钮：无
        - 弹窗无关闭接口：需要有改问题的界面截图 以及 该界面所在的activity name
### 页面4：知识库
主要用于展示我们这几个类别的定义和例子
## 数据处理后台（java、spring boot）
### 接口1：接受上传的app
自动生成此次的提交hash，并分析出该app的package name以及版本号，然后将app存储到磁盘（特别说明下，可能一个用户会上传同一款app的同一版本多次，因此我们需要重新命名为：提交hash.apk），并将前端发过来的app的信息存储到数据库app_info。
上述操作处理完后，生成任务，发送到消息队列组件，任务内容为本次提交的10位数hash
### 接口2：查询审计结果
用于查询前端发来提交hash对应的app的审计结果，返回内容可以如下：
- 未审计完成的，直接返回空的结果
- 审计完成的，返回的内容包括：
    - 该次提交的app的具体信息：提交hash、app的package name、app的名字、app的版本号、提交时间、审计完成状态
    - 各个类别的审计结果，如：
        - 虚假按钮：无
        - 弹窗无关闭按钮：有
            - 对应有问题的界面截图url，对应当前界面的activity name
### 接口3：审计查询报告下载
对应内容跟接口2一样，只不过这个接口是直接下载对应的结果报告给浏览器那边
## 审计后台（python）
审计后台的主要工作：
1. 启动时订阅任务消息队列
2. 从消息队列收到任务后，开始执行审计任务，主要步骤为：
- 根据任务消息里提供的提交hash，查找app_info表，找到该提交hash对应的package name，然后检查当前手机是否有下载到该app，有则删除掉，否则下一步
- 根据提交hash下载对应的app
- 下载完后，运行自动化运行模块，然后收集各个界面截图以及对应的xml文件，然后存储起来（也就是之前的做法）
- 根据自动化运行模块收集的界面数据，分发到各个类别识别模块分别去识别，并统计最终结果，然后将结果写入数据库（audit_info表，id自增主键，提交hash二级索引，类别type，问题截图的图片路径，activity name）：
- 然后将app_info表中对应提交hash的status状态数据项设置为done，代表已完成
  